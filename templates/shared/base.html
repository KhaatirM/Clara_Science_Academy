<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="csrf-token" content="{{ csrf_token() }}">
    <!-- Content Security Policy is handled by Flask app headers -->
    <title>{% block title %}Clara Science Academy{% endblock %}</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='modal-styles.css') }}">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Global CSS to hide CSRF tokens -->
    <style>
        /* Hide any visible CSRF tokens */
        input[name="csrf_token"] {
            display: none !important;
            visibility: hidden !important;
            position: absolute !important;
            left: -9999px !important;
        }
        
        /* Hide any text that looks like a CSRF token */
        body *:not(input):not(script):not(style):not(meta) {
            font-family: inherit;
        }
    </style>
</head>
<!-- ADDED: A block to allow child templates to add attributes to the body tag -->
<body {% block body_attributes %}{% endblock %}>
    <!-- Using a custom class for the green navbar -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-custom-green">
        <div class="container-fluid">
            <a class="navbar-brand" href="{{ url_for('auth.home') }}">Clara Science Academy</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    {% if current_user.is_authenticated %}
                        <li class="nav-item">
                            <span class="navbar-text me-3">
                                Welcome, {{ current_user.username }} ({{ current_user.role }})
                            </span>
                        </li>
                        <li class="nav-item">
                            {% set role_name = current_user.role|lower|replace(' ', '_') %}
                            {% if role_name == 'school_administrator' %}
                                {% set dashboard_url = url_for('management.management_dashboard') %}
                            {% elif role_name == 'director' %}
                                {% set dashboard_url = url_for('management.management_dashboard') %}
                            {% elif role_name == 'teacher' %}
                                {% set dashboard_url = url_for('teacher.teacher_dashboard') %}
                            {% elif role_name == 'student' %}
                                {% set dashboard_url = url_for('student.student_dashboard') %}
                            {% elif role_name == 'tech' %}
                                {% set dashboard_url = url_for('tech.tech_dashboard') %}
                            {% else %}
                                {% set dashboard_url = url_for('auth.dashboard') %}
                            {% endif %}
                            <a class="nav-link" href="{{ dashboard_url }}">Dashboard</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="{{ url_for('auth.logout') }}">Logout</a>
                        </li>
                    {% else %}
                        <li class="nav-item">
                            <a class="nav-link" href="{{ url_for('auth.home') }}">Home</a>
                        </li>
                        
                        <!-- About Us Dropdown -->
                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle" href="#" id="aboutUsDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                                About Us
                            </a>
                            <ul class="dropdown-menu" aria-labelledby="aboutUsDropdown">
                                <li><a class="dropdown-item" href="#" data-page="education-plan">Education Plan</a></li>
                                <li><a class="dropdown-item" href="#" data-page="stem-manifesto">STEM Manifesto</a></li>
                                <li><a class="dropdown-item" href="#" data-page="tuition-assistance">Tuition Assistance</a></li>
                                <li><a class="dropdown-item" href="#" data-page="admission-policy">Admission Policy</a></li>
                                <li><a class="dropdown-item" href="#" data-page="locations">Locations</a></li>
                                <li><a class="dropdown-item" href="#" data-page="board-of-directors">Board of Directors</a></li>
                                <li><a class="dropdown-item" href="#" data-page="board-meeting-minutes">Board Meeting Minutes</a></li>
                            </ul>
                        </li>
                        
                        <!-- CSA Info Dropdown -->
                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle" href="#" id="csaInfoDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                                CSA Info
                            </a>
                            <ul class="dropdown-menu" aria-labelledby="csaInfoDropdown">
                                <li><a class="dropdown-item" href="#" data-page="employment">Employment</a></li>
                                <li><a class="dropdown-item" href="#" data-page="survey">Survey</a></li>
                                <li><a class="dropdown-item" href="#" data-page="academic-calendar">Academic Calendar</a></li>
                                <li><a class="dropdown-item" href="#" data-page="parent-staff-resources">Parent & Staff Resources</a></li>
                                <li><a class="dropdown-item" href="#" data-page="clarabytes">ClaraBytes</a></li>
                            </ul>
                        </li>
                        
                        <li class="nav-item">
                            <a class="nav-link" href="#" data-page="enrollment">Enrollment</a>
                        </li>
                        
                        <li class="nav-item">
                            <a class="nav-link" href="#" data-page="faq">FAQ</a>
                        </li>
                        
                        <li class="nav-item">
                            <a class="nav-link" href="#" data-page="contact-us">Contact Us</a>
                        </li>
                        
                        <li class="nav-item">
                            <a class="nav-link" href="{{ url_for('auth.login') }}">Login</a>
                        </li>
                    {% endif %}
                </ul>
            </div>
        </div>
    </nav>

    <main class="container mt-4">
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                {% for category, message in messages %}
                <div class="alert alert-{{ category }} alert-dismissible fade show" role="alert">
                    {{ message }}
                    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                </div>
                {% endfor %}
            {% endif %}
        {% endwith %}
        {% block content %}{% endblock %}
    </main>
    
    <!-- Password Change Modal -->
    {% if current_user.is_authenticated and current_user.is_temporary_password %}
        {% include 'shared/password_change_modal.html' %}
    {% endif %}
    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Global JavaScript to hide CSRF tokens -->
    <script>
        // Remove any visible CSRF tokens
        function removeVisibleCSRFTokens() {
            const walker = document.createTreeWalker(
                document.body,
                NodeFilter.SHOW_TEXT,
                null,
                false
            );
            
            let node;
            while (node = walker.nextNode()) {
                if (node.textContent && node.textContent.trim()) {
                    const text = node.textContent.trim();
                    // Match CSRF token pattern (base64-like with dots)
                    if (text.match(/^[A-Za-z0-9+/=]+\.[A-Za-z0-9+/=]+\.[A-Za-z0-9+/=]+$/) && text.length > 20) {
                        console.log('Removing visible CSRF token:', text);
                        node.remove();
                    }
                }
            }
        }
        
        // Run on page load and after delays
        document.addEventListener('DOMContentLoaded', function() {
            removeVisibleCSRFTokens();
            setTimeout(removeVisibleCSRFTokens, 100);
            setTimeout(removeVisibleCSRFTokens, 500);
        });
        
        // Also run on DOM mutations
        const observer = new MutationObserver(function(mutations) {
            mutations.forEach(function(mutation) {
                if (mutation.type === 'childList') {
                    removeVisibleCSRFTokens();
                }
            });
        });
        
        observer.observe(document.body, {
            childList: true,
            subtree: true
        });
        
        // Navigation dropdown functionality
        document.addEventListener('DOMContentLoaded', function() {
            // Use event delegation to handle clicks on dynamically added content
            document.addEventListener('click', function(e) {
                // Check if the clicked element or its parent has data-page attribute
                const target = e.target.closest('[data-page]');
                if (target) {
                    e.preventDefault();
                    const page = target.getAttribute('data-page');
                    showPageModal(page);
                }
            });
        });
        
        function showPageModal(page) {
            // Create modal if it doesn't exist
            let modal = document.getElementById('pageModal');
            if (!modal) {
                modal = createModal();
                document.body.appendChild(modal);
            }
            
            // Show specific content based on page
            if (page === 'faq') {
                showFAQModal(modal);
            } else if (page === 'contact-us') {
                showContactUsModal(modal);
            } else if (page === 'employment') {
                showEmploymentModal(modal);
            } else {
                showPlaceholderModal(modal, page);
            }
            
            // Show the modal
            const bootstrapModal = new bootstrap.Modal(modal);
            bootstrapModal.show();
        }
        
        function createModal() {
            
            const modal = document.createElement('div');
            modal.id = 'pageModal';
            modal.className = 'modal fade enhanced-modal';
            modal.setAttribute('tabindex', '-1');
            modal.setAttribute('aria-labelledby', 'pageModalLabel');
            modal.setAttribute('aria-hidden', 'true');
            modal.innerHTML = `
                <div class="modal-dialog modal-xl">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="pageModalLabel"></h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <div class="modal-body" id="modalBody">
                            <!-- Content will be loaded here -->
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                                <i class="fas fa-times me-2"></i>Close
                            </button>
                        </div>
                    </div>
                </div>
            `;
            return modal;
        }
        
        function showFAQModal(modal) {
            const modalTitle = modal.querySelector('#pageModalLabel');
            const modalBody = modal.querySelector('#modalBody');
            
            modalTitle.innerHTML = '<i class="fas fa-question-circle me-2"></i>Frequently Asked Questions';
            modalBody.innerHTML = `
                <div class="welcome-section">
                    <h4 class="mb-3">
                        <i class="fas fa-info-circle me-2"></i>Get Answers to Common Questions
                    </h4>
                    <p class="text-muted mb-0">Find quick answers to the most frequently asked questions about Clara Science Academy.</p>
                </div>
                <div class="accordion faq-accordion" id="faqAccordion">
                    <!-- FAQ Items will be added here -->
                </div>
                <div class="text-center mt-4">
                    <div class="alert alert-info">
                        <h6 class="alert-heading">
                            <i class="fas fa-lightbulb me-2"></i>Still have questions?
                        </h6>
                        <p class="mb-2">Can't find what you're looking for? We're here to help!</p>
                        <a href="#" data-page="contact-us" class="btn btn-outline-primary btn-sm">
                            <i class="fas fa-envelope me-2"></i>Contact Us
                        </a>
                    </div>
                </div>
            `;
            
            // Add FAQ items after the content is loaded
            setTimeout(() => {
                addFAQItems();
            }, 100);
        }
        
        function showContactUsModal(modal) {
            const modalTitle = modal.querySelector('#pageModalLabel');
            const modalBody = modal.querySelector('#modalBody');
            
            modalTitle.innerHTML = '<i class="fas fa-envelope me-2"></i>Contact Us';
            modalBody.innerHTML = `
                <div class="welcome-section">
                    <h4 class="mb-3">
                        <i class="fas fa-handshake me-2"></i>Get in Touch with Us
                    </h4>
                    <p class="text-muted mb-0">We're here to help! Reach out to us through any of the methods below.</p>
                </div>
                
                <div class="row">
                    <!-- Contact Information -->
                    <div class="col-md-6 mb-4">
                        <div class="contact-info-section">
                            <div class="contact-info">
                                <h4 class="text-primary mb-3">
                                    <i class="fas fa-map-marker-alt me-2"></i>Mailing Address
                                </h4>
                                <p class="mb-2">
                                    <strong>Clara Science Academy</strong><br>
                                    2812 East Bessemer Ave.<br>
                                    Greensboro, NC 27405
                                </p>
                                
                                <h4 class="text-primary mb-3 mt-4">
                                    <i class="fas fa-phone me-2"></i>Phone
                                </h4>
                                <p class="mb-2">
                                    <strong>1-800-567-5110</strong>
                                </p>
                                
                                <h4 class="text-primary mb-3 mt-4">
                                    <i class="fas fa-envelope me-2"></i>Email
                                </h4>
                                <p class="mb-2">
                                    <strong>info@clarascienceacademy.com</strong>
                                </p>
                                
                                <div class="mt-4">
                                    <h4 class="text-primary mb-3">
                                        <i class="fas fa-clock me-2"></i>Office Hours
                                    </h4>
                                    <p class="mb-1"><strong>Monday - Friday:</strong> 8:00 AM - 5:00 PM</p>
                                    <p class="mb-0"><strong>Saturday:</strong> 9:00 AM - 1:00 PM</p>
                                    <p class="text-muted small mt-2">Closed on Sundays and major holidays</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Contact Form -->
                    <div class="col-md-6 mb-4">
                        <div class="contact-form-section">
                            <h4 class="text-primary mb-3">
                                <i class="fas fa-paper-plane me-2"></i>Send us a Message
                            </h4>
                            <form id="contactForm">
                                <div class="mb-3">
                                    <label for="contactName" class="form-label">Name <span class="text-danger">*</span></label>
                                    <input type="text" class="form-control" id="contactName" name="name" required>
                                    <div class="form-text">Please enter your full name</div>
                                </div>
                                
                                <div class="mb-3">
                                    <label for="contactEmail" class="form-label">Email Address <span class="text-danger">*</span></label>
                                    <input type="email" class="form-control" id="contactEmail" name="email" required>
                                    <div class="form-text">Please enter a valid email address</div>
                                </div>
                                
                                <div class="mb-3">
                                    <label for="contactPhone" class="form-label">Phone Number <span class="text-danger">*</span></label>
                                    <input type="tel" class="form-control" id="contactPhone" name="phone" required>
                                    <div class="form-text">Please enter your complete phone number</div>
                                </div>
                                
                                <div class="mb-3">
                                    <label for="contactMessage" class="form-label">Message <span class="text-danger">*</span></label>
                                    <textarea class="form-control" id="contactMessage" name="message" rows="5" maxlength="180" required></textarea>
                                    <div class="form-text">
                                        <span id="charCount">0</span> / 180 characters
                                    </div>
                                </div>
                                
                                <div class="mb-3">
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="spamCheck" name="spamCheck">
                                        <label class="form-check-label text-muted" for="spamCheck">
                                            Please do not fill in this field.
                                        </label>
                                    </div>
                                </div>
                                
                                <button type="submit" class="btn btn-primary w-100">
                                    <i class="fas fa-paper-plane me-2"></i>Send Message
                                </button>
                            </form>
                        </div>
                    </div>
                </div>
                
                <!-- Additional Information -->
                <div class="row mt-4">
                    <div class="col-12">
                        <div class="alert alert-info">
                            <h5 class="alert-heading">
                                <i class="fas fa-info-circle me-2"></i>Additional Ways to Connect
                            </h5>
                            <p class="mb-2">You can also contact us through our main website:</p>
                            <p class="mb-0">
                                <a href="https://clarascienceacademy.com/contact-us/" target="_blank" class="btn btn-outline-info">
                                    <i class="fas fa-external-link-alt me-2"></i>Visit Our Main Website
                                </a>
                            </p>
                        </div>
                    </div>
                </div>
            `;
            
            // Add contact form functionality after the content is loaded
            setTimeout(() => {
                setupContactForm();
            }, 100);
        }
        
        function showEmploymentModal(modal) {
            const modalTitle = modal.querySelector('#pageModalLabel');
            const modalBody = modal.querySelector('#modalBody');
            
            modalTitle.innerHTML = '<i class="fas fa-briefcase me-2"></i>Employment Opportunities';
            modalBody.innerHTML = `
                <div class="welcome-section">
                    <h4 class="mb-3">
                        <i class="fas fa-handshake me-2"></i>Join Our Team
                    </h4>
                    <p class="text-muted mb-0">We believe in a strong sense of community centered around collaboration, partnership, and achievement. If you share our mission, values, and approach, we'd love to hear from you. The school will consider only top candidates with relevant experience and a proven track record.</p>
                </div>
                
                <div class="row">
                    <div class="col-12">
                        <div class="employment-positions">
                            <!-- Elementary Principal -->
                            <div class="position-card">
                                <div class="position-header">
                                    <h5 class="position-title">
                                        <i class="fas fa-user-tie me-2"></i>Elementary Principal
                                    </h5>
                                    <div class="position-actions">
                                        <a href="{{ url_for('static', filename='JobDescriptions/Elementary_Principal_Job_Description.pdf') }}" target="_blank" class="btn btn-outline-primary btn-sm">
                                            <i class="fas fa-file-pdf me-1"></i>Full Job Description
                                        </a>
                                        <a href="https://clarascienceacademy.com/apply-instantly/" target="_blank" class="btn btn-primary btn-sm">
                                            <i class="fas fa-paper-plane me-1"></i>Apply Instantly
                                        </a>
                                    </div>
                                </div>
                                <div class="position-summary">
                                    <p>An elementary school principal must regularly meet with the school board to make sure school plans are aligned with the mission. As a leader, the principal makes the board aware of the needs of the students and staff at his school and also communicates school information to teachers, students and parents.</p>
                                    <p><strong>Salary:</strong> According to the U.S. Bureau of Labor Statistics, the median annual pay for K-12 principals is $86,970.</p>
                                </div>
                            </div>
                            
                            <!-- Teacher -->
                            <div class="position-card">
                                <div class="position-header">
                                    <h5 class="position-title">
                                        <i class="fas fa-chalkboard-teacher me-2"></i>Teacher
                                    </h5>
                                    <div class="position-actions">
                                        <a href="{{ url_for('static', filename='JobDescriptions/Teacher_Job_Description.pdf') }}" target="_blank" class="btn btn-outline-primary btn-sm">
                                            <i class="fas fa-file-pdf me-1"></i>Full Job Description
                                        </a>
                                        <a href="https://clarascienceacademy.com/apply-instantly/" target="_blank" class="btn btn-primary btn-sm">
                                            <i class="fas fa-paper-plane me-1"></i>Apply Instantly
                                        </a>
                                    </div>
                                </div>
                                <div class="position-summary">
                                    <p>We are on the hunt for a self-motivated and experienced Teacher to join our qualified team of educators. As a Teacher, you will be responsible for cultivating the students' interest in education and development.</p>
                                </div>
                            </div>
                            
                            <!-- Guidance Counselor -->
                            <div class="position-card">
                                <div class="position-header">
                                    <h5 class="position-title">
                                        <i class="fas fa-user-graduate me-2"></i>Guidance Counselor
                                    </h5>
                                    <div class="position-actions">
                                        <a href="{{ url_for('static', filename='JobDescriptions/Guidance_Counselor_Job_Description.pdf') }}" target="_blank" class="btn btn-outline-primary btn-sm">
                                            <i class="fas fa-file-pdf me-1"></i>Full Job Description
                                        </a>
                                        <a href="https://clarascienceacademy.com/apply-instantly/" target="_blank" class="btn btn-primary btn-sm">
                                            <i class="fas fa-paper-plane me-1"></i>Apply Instantly
                                        </a>
                                    </div>
                                </div>
                                <div class="position-summary">
                                    <p>We are looking to hire a Guidance Counselor with outstanding assessment and listening skills. Guidance Counselors are expected to display empathy and sound decision-making with great organizational and motivational skills.</p>
                                </div>
                            </div>
                            
                            <!-- Teacher Assistant -->
                            <div class="position-card">
                                <div class="position-header">
                                    <h5 class="position-title">
                                        <i class="fas fa-hands-helping me-2"></i>Teacher Assistant
                                    </h5>
                                    <div class="position-actions">
                                        <a href="{{ url_for('static', filename='JobDescriptions/Teacher_Assistant_Job_Description.pdf') }}" target="_blank" class="btn btn-outline-primary btn-sm">
                                            <i class="fas fa-file-pdf me-1"></i>Full Job Description
                                        </a>
                                        <a href="https://clarascienceacademy.com/apply-instantly/" target="_blank" class="btn btn-primary btn-sm">
                                            <i class="fas fa-paper-plane me-1"></i>Apply Instantly
                                        </a>
                                    </div>
                                </div>
                                <div class="position-summary">
                                    <p>We are currently looking for a friendly and competent Teacher Assistant to join our team. If you are a compassionate and self-motivated individual with a specific interest in education, we urge you to apply!</p>
                                </div>
                            </div>
                            
                            <!-- Substitute Teacher -->
                            <div class="position-card">
                                <div class="position-header">
                                    <h5 class="position-title">
                                        <i class="fas fa-exchange-alt me-2"></i>Substitute Teacher
                                    </h5>
                                    <div class="position-actions">
                                        <a href="{{ url_for('static', filename='JobDescriptions/Substitute_Teacher_Job_Description.pdf') }}" target="_blank" class="btn btn-outline-primary btn-sm">
                                            <i class="fas fa-file-pdf me-1"></i>Full Job Description
                                        </a>
                                        <a href="https://clarascienceacademy.com/apply-instantly/" target="_blank" class="btn btn-primary btn-sm">
                                            <i class="fas fa-paper-plane me-1"></i>Apply Instantly
                                        </a>
                                    </div>
                                </div>
                                <div class="position-summary">
                                    <p>We are currently searching for a confident and experienced Substitute Teacher to join our team. If you are a friendly and competent professional with interest in education, then we're interested in you.</p>
                                </div>
                            </div>
                            
                            <!-- School Nurse -->
                            <div class="position-card">
                                <div class="position-header">
                                    <h5 class="position-title">
                                        <i class="fas fa-user-nurse me-2"></i>School Nurse
                                    </h5>
                                    <div class="position-actions">
                                        <a href="{{ url_for('static', filename='JobDescriptions/School_Nurse_Job_Description.pdf') }}" target="_blank" class="btn btn-outline-primary btn-sm">
                                            <i class="fas fa-file-pdf me-1"></i>Full Job Description
                                        </a>
                                        <a href="https://clarascienceacademy.com/apply-instantly/" target="_blank" class="btn btn-primary btn-sm">
                                            <i class="fas fa-paper-plane me-1"></i>Apply Instantly
                                        </a>
                                    </div>
                                </div>
                                <div class="position-summary">
                                    <p>Just looking after the children in a school is not the only part of a school nurse job description. The school nurses also look after the staff. School nurses have a very important job looking after all the children and tending to all their medical needs.</p>
                                </div>
                            </div>
                            
                            <!-- Exceptional Children's Teacher -->
                            <div class="position-card">
                                <div class="position-header">
                                    <h5 class="position-title">
                                        <i class="fas fa-heart me-2"></i>Exceptional Children's Teacher
                                    </h5>
                                    <div class="position-actions">
                                        <a href="{{ url_for('static', filename='JobDescriptions/Exceptional_Children_Teacher_Job_Description.pdf') }}" target="_blank" class="btn btn-outline-primary btn-sm">
                                            <i class="fas fa-file-pdf me-1"></i>Full Job Description
                                        </a>
                                        <a href="https://clarascienceacademy.com/apply-instantly/" target="_blank" class="btn btn-primary btn-sm">
                                            <i class="fas fa-paper-plane me-1"></i>Apply Instantly
                                        </a>
                                    </div>
                                </div>
                                <div class="position-summary">
                                    <p>Under general supervision, provides special education services to students identified as disabled in accordance with state and federal regulations. Work involves developing and implementing the Individual Education Program in classroom settings.</p>
                                </div>
                            </div>
                            
                            <!-- Coming Soon Positions -->
                            <div class="position-card coming-soon">
                                <div class="position-header">
                                    <h5 class="position-title">
                                        <i class="fas fa-clock me-2"></i>Additional Positions Coming Soon
                                    </h5>
                                </div>
                                <div class="position-summary">
                                    <p>We are also planning to add the following positions:</p>
                                    <ul class="list-unstyled">
                                        <li><i class="fas fa-users me-2"></i>Human Resource Officer</li>
                                        <li><i class="fas fa-clipboard-list me-2"></i>Office Manager</li>
                                        <li><i class="fas fa-search me-2"></i>Student Recruitment Specialist</li>
                                    </ul>
                                    <p class="text-muted">Job descriptions for these positions will be available soon.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="text-center mt-4">
                    <div class="alert alert-info">
                        <h6 class="alert-heading">
                            <i class="fas fa-info-circle me-2"></i>Ready to Apply?
                        </h6>
                        <p class="mb-2">Click "Apply Instantly" on any position to be taken to our application portal.</p>
                        <p class="mb-0">Please be sure to attach your resume for consideration.</p>
                    </div>
                </div>
            `;
        }
        
        function showPlaceholderModal(modal, page) {
            const modalTitle = modal.querySelector('#pageModalLabel');
            const modalBody = modal.querySelector('#modalBody');
            
            modalTitle.textContent = getPageTitle(page);
            modalBody.innerHTML = `
                <div class="text-center">
                    <div class="alert alert-info">
                        <i class="fas fa-info-circle me-2"></i>
                        Content for "${getPageTitle(page)}" will be added here.
                    </div>
                    <p class="text-muted">This page is under construction. Please check back later for detailed information.</p>
                </div>
            `;
        }
        
        function getPageTitle(page) {
            const titles = {
                'education-plan': 'Education Plan',
                'stem-manifesto': 'STEM Manifesto',
                'tuition-assistance': 'Tuition Assistance',
                'admission-policy': 'Admission Policy',
                'locations': 'Locations',
                'board-of-directors': 'Board of Directors',
                'board-meeting-minutes': 'Board Meeting Minutes',
                'employment': 'Employment',
                'survey': 'Survey',
                'academic-calendar': 'Academic Calendar',
                'parent-staff-resources': 'Parent & Staff Resources',
                'clarabytes': 'ClaraBytes',
                'enrollment': 'Enrollment',
                'faq': 'FAQ',
                'contact-us': 'Contact Us'
            };
            return titles[page] || page;
        }
        
        
        function addFAQItems() {
            const accordion = document.getElementById('faqAccordion');
            if (!accordion) return;
            
            const faqItems = [
                {
                    id: 1,
                    question: "When will the school be available for opening?",
                    answer: "Clara Science Academy (CSA) will open in Greensboro in the 2024-2025 school year."
                },
                {
                    id: 2,
                    question: "What should we expect the grade levels to be?",
                    answer: "CSA will begin with grades K-6 and a new grade level will be added each year until we reach grades K-8."
                },
                {
                    id: 3,
                    question: "Where is Clara Science Academy located?",
                    answer: "The school will be located in Greensboro, NC (future locations to be announced in Charlotte, NC, Philadelphia, PA, and Newark, NJ)."
                },
                {
                    id: 4,
                    question: "What is special about your curriculum?",
                    answer: `STEM is a curriculum based on the idea of educating students in four specific disciplines — science, technology, engineering and mathematics — in an interdisciplinary and applied approach. Rather than teach the four disciplines as separate and discrete subjects, STEM integrates them into a cohesive learning paradigm based on real-world applications.
                    <br><br>
                    While placing STEM at the center of our curriculum, it is used to provide a fundamental purpose, definition and identity to the school. A STEM curriculum will be used throughout every classroom. This will be evident in daily instructional techniques, such as using music or drawing to represent thinking, and culminating unit tasks where students synthesize and display their final understanding through a STEM-based project.
                    <br><br>
                    <strong>Important Facts about STEM:</strong><br>
                    Though the United States has historically been a leader in these fields, fewer students have been focusing on these topics recently. According to the U.S. Department of Education, only 16 percent of high school students are interested in a STEM career and have proven a proficiency in mathematics. Currently, nearly 28 percent of high school freshmen declare an interest in a STEM-related field, a department website says, but 57 percent of these students will lose interest by the time they graduate from high school.`
                },
                {
                    id: 5,
                    question: "When does school begin and end?",
                    answer: `<strong>Drop off:</strong> 7:45 a.m.<br>
                    <strong>School begins:</strong> 8:00 a.m.<br>
                    <strong>School ends:</strong> 4:00 p.m.`
                },
                {
                    id: 6,
                    question: "Will you have a before and after school program?",
                    answer: "Yes. We will implement these programs as we learn more about the needs of our students and families. (TBA)"
                },
                {
                    id: 7,
                    question: "How do I enroll my child?",
                    answer: `First complete the short application interest form available under the Enrollment menu item.
                    <br><br>
                    Open enrollment will take place between the months of January and February of the school year. Notification of acceptance will be announced in March.
                    <br><br>
                    Those applicants who were not accepted will be placed on a waiting list. Rolling admissions will continue until all seats are filled.`
                },
                {
                    id: 8,
                    question: "Do siblings get enrollment preference?",
                    answer: `Per the statute, sibling preference can be granted "to siblings of currently enrolled students who were admitted into the school in a previous year." A brand new school does not have any currently enrolled students from the previous year, so that preference cannot be granted in the first year of operation. By the second year, one surname for all the siblings applying will be granted admission at the same time.
                    <br><br>
                    The definition of sibling is any of the following who reside in the same household: half siblings, step-siblings, and children residing in a family foster home.`
                },
                {
                    id: 9,
                    question: "Is the school using the lottery process?",
                    answer: "CSA will use the lottery process for enrollment. (TBA)"
                },
                {
                    id: 10,
                    question: "Do you offer resources for students with special needs?",
                    answer: "Yes. The school will employ qualified staff for Exceptional Children and will implement a School Support Team of teachers and EC specialists. (TBA)"
                },
                {
                    id: 11,
                    question: "Is lunch provided?",
                    answer: "Yes. A complete lunch plan will be available to all registered students at the beginning of the school year. (TBA)"
                },
                {
                    id: 12,
                    question: "Is transportation provided?",
                    answer: "Yes. A complete transportation plan will be available at the beginning of the school year. (TBA)"
                }
            ];
            
            faqItems.forEach(item => {
                const accordionItem = document.createElement('div');
                accordionItem.className = 'accordion-item';
                accordionItem.innerHTML = `
                    <h2 class="accordion-header" id="heading${item.id}">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapse${item.id}" aria-expanded="false" aria-controls="collapse${item.id}">
                            ${item.question}
                        </button>
                    </h2>
                    <div id="collapse${item.id}" class="accordion-collapse collapse" aria-labelledby="heading${item.id}" data-bs-parent="#faqAccordion">
                        <div class="accordion-body">
                            ${item.answer}
                        </div>
                    </div>
                `;
                accordion.appendChild(accordionItem);
            });
        }
        
        function setupContactForm() {
            const contactForm = document.getElementById('contactForm');
            const charCount = document.getElementById('charCount');
            const messageTextarea = document.getElementById('contactMessage');
            
            if (!contactForm) return;
            
            // Character counter for message
            if (messageTextarea && charCount) {
                messageTextarea.addEventListener('input', function() {
                    charCount.textContent = this.value.length;
                });
            }
            
            // Form submission
            contactForm.addEventListener('submit', function(e) {
                e.preventDefault();
                
                // Get form data
                const formData = new FormData(this);
                const name = formData.get('name');
                const email = formData.get('email');
                const phone = formData.get('phone');
                const message = formData.get('message');
                
                // Basic validation
                if (!name || !email || !phone || !message) {
                    alert('Please fill in all required fields.');
                    return;
                }
                
                // Email validation
                const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                if (!emailRegex.test(email)) {
                    alert('Please enter a valid email address.');
                    return;
                }
                
                // Show success message
                alert('Thank you for your message! We will get back to you as soon as possible.\\n\\nFor immediate assistance, please call us at 1-800-567-5110 or email us at info@clarascienceacademy.com');
                
                // Reset form
                this.reset();
                if (charCount) {
                    charCount.textContent = '0';
                }
            });
        }
    </script>
    
    <!-- Password Change Popup Modal -->
    {% if current_user.is_authenticated and current_user.is_temporary_password %}
        {% include 'shared/password_change_popup.html' %}
    {% elif current_user.is_authenticated and current_user.login_count == 1 and not current_user.password_changed_at %}
        {% include 'shared/password_change_popup.html' %}
    {% endif %}
    
    {% block scripts %}{% endblock %}
    
    <!-- Error Capture System -->
    <script src="{{ url_for('static', filename='js/error_capture.js') }}"></script>
</body>
</html>
