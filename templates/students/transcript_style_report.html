<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Transcript for {{ student.name }}</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='report_card_styles.css', _external=True) }}">
</head>
<body>
    {% include 'management/_report_card_header.html' %}

    <p class="report-period-line"><strong>Report Period:</strong> {{ school_year }}</p>

    <div class="section-title">Progress/Grades</div>
    <div class="grades-layout-container">
        <div class="grades-text">
            <p>Clara Science Academy reports student performance quarterly. Students in Middle School are expected to work daily based on Teachers’ lessons and assignments. These assignments are evaluated and a grade score based on the grading system below is determined.</p>
            <p>Appropriate academy progress and achievement is reflected in completion of expected progress and mastery of concepts and skills assessed based on submitted assignments and classroom performance. Both submitted assignments and classroom performance will be taken into consideration when determining student promotion.</p>
        </div>
        <div class="grading-scale">
            <h6>Grading Scale</h6>
            <table>
                <tr><td>A</td><td>100-95</td></tr>
                <tr><td>A-</td><td>94-90</td></tr>
                <tr><td>B+</td><td>89-87</td></tr>
                <tr><td>B</td><td>86-83</td></tr>
                <tr><td>B-</td><td>82-80</td></tr>
                <tr><td>C+</td><td>79-77</td></tr>
                <tr><td>C</td><td>76-73</td></tr>
                <tr><td>C-</td><td>72-70</td></tr>
                <tr><td>D</td><td>69-65</td></tr>
                <tr><td>F</td><td>64-0</td></tr>
                <tr><td>P</td><td>Pass</td></tr>
                <tr><td>I</td><td>Incomplete</td></tr>
            </table>
        </div>
    </div>
    <div class="section-title">Subject Grades & Teacher Comments</div>
    <table>
        <thead>
            <tr>
                <th style="width: 40%;">Subject/Teacher</th>
                <th style="width: 10%;">Q1</th>
                <th style="width: 10%;">Q2</th>
                <th style="width: 10%;">Q3</th>
                <th style="width: 10%;">Q4</th>
                <th style="width: 20%;">Comments</th>
            </tr>
        </thead>
        <tbody>
            {% for class_id, data in class_grades_data.items() %}
            <tr>
                {% set class_info = data.class_info if data.class_info is defined else data.class_obj if data.class_obj is defined else None %}
                <td>{{ class_info.name if class_info else 'N/A' }} / {{ (class_info.teacher.first_name + ' ' + class_info.teacher.last_name) if class_info and class_info.teacher else 'N/A' }}</td>
                <td>{{ data.grades.Q1 if data.grades else '—' }}</td>
                <td>{{ data.grades.Q2 if data.grades else '—' }}</td>
                <td>{{ data.grades.Q3 if data.grades else '—' }}</td>
                <td>{{ data.grades.Q4 if data.grades else '—' }}</td>
                <td style="white-space: normal;">{{ data.comments | join('<br>') | safe if data.comments else '' }}</td>
            </tr>
            {% else %}
            <tr>
                <td colspan="6" style="text-align: center;">No report card data found for the selected criteria.</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <div class="section-title">Additional Comment/Concern:</div>
    <div class="comments-box" style="min-height: 50px;">
        <p>N/A</p>
    </div>

    <div class="footer">
        <p>Parent Comment: ___________________________________</p>
        <p>Parent Signature: ___________________________________ Date: _________________</p>
        <p>Academy Director: ___________________________________ Date: _________________</p>
    </div>
</body>
</html>
